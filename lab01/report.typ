#import "@local/uni:0.2.0": *
 
#let std_name = sys.inputs.at("name", default: "looomenn")
#let std_group = sys.inputs.at("group", default: "XX-00")
#let teacher = sys.inputs.at("teacher", default: "Mykola Parasuk")

#show: project.with(
  work_type: "Комп'ютерний практикум",
  number: "1",
  discipline: "Комплексні системи захисту інформації",
  topic: "Комплексне оцінювання систем захисту інформації",
  student_name: std_group+"\n"+std_name,
  teacher_name: teacher,
  year: 2025,
  extra_info: ("Варіант":"1")
)

#let O(i) = $O_#i$
#let H(i) = $H_#i$
#let E(i) = $E_#i$

#outline()
#pagebreak()

= Мета

Опанування методики оцінювання ефективності впровадженої системи захисту на основі експертного методу. Набуття вмінь складання опитувальних листів щодо оцінки стану інформаційної безпеки в установі. Автоматизація процесу оцінки на основі розробленого програмного забезпечення.

= Хід роботи

Вимога коду:
- `python >= 3.10`
Повний вихідний код доступний на репозиторії @code


== Генерація матриць оцінок
Необхідно програмно згенерувати тривимірну матрицю розмірністю 4х5х7 ($K=140$ елементів 2), що відповідає показникам:
- $O$ (Основи) – 4 елементи;
- $H$ (Напрямки) – 5 елементів;
- $E$ (Етапи) – 7 елементів.

\
Потрібно створити три варіанти представлення: A (0..1), B (0 або 1), C (1..5).

\
Реалізація:

#code_box(title:"main.py", info:"python")[
  ```python
  THRESHOLDS = {0.3: 1, 0.5: 2, 0.7: 3, 0.9: 4, 1.0: 5}

  def generate_matrix_a(self) -> list[list[list[float]]]:
      """Generates matrix A with random values [0, 1)."""
      return [
          [[random.random() for _ in range(self.dim_o)] 
            for _ in range(self.dim_h)]
          for _ in range(self.dim_e)
      ]

  def generate_matrix_b(self, matrix_a: list[list[list[float]]]) -> list[list[list[int]]]:
      """Generates a binary matrix B based on A (threshold 0.5)."""
      return [
          [[1 if val > 0.5 else 0 for val in row] for row in plane]
          for plane in matrix_a
      ]

  def generate_matrix_c(self, matrix_a: list[list[list[float]]]) -> list[list[list[int]]]:
      """Generates a matrix of ratings C (1-5) based on A."""
      return [
          [[self._get_mark_from_value(val) for val in row] for row in plane]
          for plane in matrix_a
      ]

  ```
]

\
Результат виконання:


#grid(
  columns: (1fr, 1fr, 1fr),
  column-gutter: 10pt,
  [
    #code_box(title:"plaintext")[
      ```
      Матриця A (0..1):
      E1:
        H1: 0.39 0.23 0.51 0.77
        H2: 0.25 0.09 0.36 0.56
        H3: 0.81 0.42 0.65 0.25
        H4: 0.43 0.18 0.36 0.68
        H5: 0.07 0.07 0.93 0.88
      E2:
        H1: 0.71 0.17 0.95 0.73
        H2: 0.01 0.07 0.24 0.91
        H3: 0.45 0.49 0.24 0.29
        H4: 0.20 0.28 0.35 0.10
        H5: 0.01 0.42 0.81 0.40
        ....
      ```
    ]
  ],
  [
    #code_box(title:"plaintext")[
      ```
      Матриця B (0 або 1):
      E1:
        H1: 0 0 1 1
        H2: 0 0 0 1
        H3: 1 0 1 0
        H4: 0 0 0 1
        H5: 0 0 1 1
      E2:
        H1: 1 0 1 1
        H2: 0 0 0 1
        H3: 0 0 0 0
        H4: 0 0 0 0
        H5: 0 0 1 0
        ....
      ```
    ]
  ],
    [
    #code_box(title:"plaintext")[
      ```
      Матриця C (1..5):
      E1:
        H1: 2 1 3 4
        H2: 1 1 2 3
        H3: 4 2 3 1
        H4: 2 1 2 3
        H5: 1 1 5 4
      E2:
        H1: 4 1 5 4
        H2: 1 1 1 5
        H3: 2 2 1 1
        H4: 1 1 2 1
        H5: 1 2 4 2
        ....
      ```
    ]
  ]
)


== Обчислення оцінки якості
Обчислити інтегральний показник якості системи, використовуючи вагові коефіцієнти для кожного виміру, згідно з формулою:

$
  Q = sum w_k sum w_j sum w_i q_(\k\j\i)
$

\
Використовуємо наступні вагові коефіцієнти
#code_box(title:"main.py", info:"python")[
  ```python
  WEIGHTS_O: list[float] = [0.3, 0.2, 0.2, 0.3]
  WEIGHTS_H: list[float] = [0.2, 0.2, 0.2, 0.2, 0.2]
  WEIGHTS_E: list[float] = [0.15, 0.15, 0.1, 0.15, 0.15, 0.15, 0.15]
  ```
]

#pagebreak()

\
Відповідна функція
#code_box(title:"main.py", info:"python")[
  ```python
  def calculate_index(self, matrix, use_weights = True) -> float:
      """Calculates the integral quality index."""
      #... 
      if use_weights:
          weight = self.WEIGHTS_E[e] * self.WEIGHTS_H[h] * self.WEIGHTS_O[o]
          total_score += val * weight
      #...
  ```
]

\
Результат виконання:
    #code_box(title:"plaintext")[
      ```
      Індекси якості
      A (з вагами): 0.458
      A (без ваг):  0.464
      B (з вагами): 0.413
      B (без ваг):  0.421
      C (з вагами): 2.377
      C (без ваг):  2.414
      ```
    ]

== Аналіз елементів
Сформулювати запитання та перевірити значення для елементів з кодами: 121, 433, 412, 117, 322.

\
Фрагмент коду, що відповідає за пошук елемента
#code_box(title:"main.py", info:"python")[
```python
def get_element_description(self, code, matrix) -> str:
  #..
  o_idx = int(s_code[0]) - 1
  h_idx = int(s_code[1]) - 1
  e_idx = int(s_code[2]) - 1
  #...
```
]

\ss
=== Формулювання запитань

#show table: set text(
  size: 9pt,
)

#table(
  columns: (auto, 1fr, 1fr, 1fr, 3fr),
  inset: 8pt,
  align: (col, row) => if col == 0 { center + horizon } else { left + horizon },
  stroke: 0.5pt + luma(150),
  table.header(
    [Код], [#O("i")], [#H("i")], [#E("i")], [Питання]
  ),
  [121], 
  [(1)\ Нормативна база],
  [(2)\ Захист процесів/програм],
  [(1)\ Виявлення інформації],
  ["Чи містить наявна нормативна база чіткі вимоги та критерії для виявлення конфіденційної інформації, що обробляється у процесах установи?"],


  [433],
  [(4)\ Програмно-технічні засоби],
  [(3)\ Захист каналів зв'язку],
  [(3)\ Оцінка ризиків],
  ["Чи застосовуються спеціалізовані програмно-технічні засоби для проведення аналізу вразливостей та оцінки ризиків у телекомунікаційних каналах зв'язку?"],


  [412],
  [(4)\ Програмно-технічні засоби],
  [(1)\ Захист об'єктів],
  [(2)\ Виявлення загроз],
  ["Чи використовуються технічні засоби охорони та спостереження для своєчасного виявлення загроз фізичного доступу до об'єктів корпоративної системи?"],


  [117],
  [(1)\ Нормативна база],
  [(1)\ Захист процесів],
  [(7)\ Контроль цілісності/керуванн],
  ["Чи регламентовано внутрішніми документами процедури контролю цілісності 
периметру безпеки та механізми керування доступом до фізичних об'єктів системи?"],

  [322],
  [(3)\ Організаційні заходи],
  [(2)\ Захист процесів],
  [(2)\ Виявлення загро],
  ["Чи розроблено організаційні інструкції та правила для персоналу щодо виявлення 
загроз та каналів витоку інформації під час виконання процедур обробки даних?"]
)

\
=== Перевірка
#code_box(title:"plaintext")[
```
Перевірка елементів
121 повністю не відповідає (Н)
433 відповідає в основному (С)
412 майже відповідає (ВС)
117 повністю не відповідає (Н)
322 повністю не відповідає (Н)
```
]

#pagebreak()

== Оцінка прийнятності системи
Суть завдання: Визначити, чи придатна система до використання, порівнявши індекс якості з еталонним значенням 0.75.

\
Фрагмент коду:
#code_box(title:"main.py", info:"python")[
```python
#...
index_a = self.calculate_index(matrix_a, True)
threshold = 0.75
status = "прийнятна" if index_a >= threshold else "не прийнятна"
#...
```
]

\
Згідно з розрахунками, отримали: 
#code_box(title:"plaintext")[
```
Система не прийнятна: 0.458 < 0.75
```
]

\
Висновок:

Система захисту інформації не є прийнятною для експлуатації у поточному стані та потребує 
доопрацювання, оскільки еталонний показник має бути  $>= 0.75$

#pagebreak()
== Визначення найслабших місць
Суть завдання: Знайти блоки, які дають найгірший внесок у загальну якість КСЗІ. Це дозволяє зрозуміти, що треба виправляти в першу чергу.

\
Фрагмент коду:
#code_box(title:"main.py", info:"python")[
```python
def find_worst_blocks(self, matrix_a, limit = 10) -> list[tuple[str, float]]:
    #...
    weight = self.WEIGHTS_E[e] * self.WEIGHTS_H[h] * self.WEIGHTS_O[o]
    code = f"{o + 1}{h + 1}{e + 1}"
    elements.append((code, val * weight))
    elements.sort(key=lambda x: x[1])
    return elements[:limit]
```
]

\
Результат виконання:
#code_box(title:"plaintext")[
```
Найгірші блоки (top 10)
214 => внесок 0.00002
225 => внесок 0.00003
152 => внесок 0.00005
113 => внесок 0.00007
122 => внесок 0.00013
345 => внесок 0.00016
423 => внесок 0.00021
144 => внесок 0.00031
251 => внесок 0.00040
313 => внесок 0.00043
```
]

#pagebreak()
= Висновки
Використана матрична модель дозволяє перетворити суб'єктивні експертні оцінки (лінгвістичні змінні) на об'єктивний кількісний показник (інтегральний індекс $Q$), що є необхідним для прийняття управлінських рішень.

\
Тривимірна структура $(O times H times E)$ гарантує, що система захисту оцінюється комплексно: не лише як набір технічних засобів, але і як сукупність правових норм, оргзаходів та процесів на всіх етапах життєвого циклу.

\
Застосування ваг дозволяє адаптувати модель під специфіку конкретної організації, надаючи пріоритет найбільш критичним аспектам безпеки (наприклад, технічному захисту каналів зв'язку), що суттєво впливає на фінальний вердикт.

\
Аналіз "найгірших блоків" виступає інструментом стратегічного планування, вказуючи на "слабкі ланки", усунення яких дасть найбільший приріст загального рівня захищеності системи при мінімальних витратах.


#pagebreak()
#bibliography("refs.yaml", style: "ieee")